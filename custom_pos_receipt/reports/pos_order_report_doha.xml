<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="pos_order_report_template_doha">
        <t t-foreach="docs" t-as="doc">
            <html>
                <head>
                    <meta charset="utf-8"/>
                    <style>
                        /* Reset all default margins and padding */
                        * {
                            margin: 0;
                            padding: 0;
                            box-sizing: border-box;
                        }
                        .page {
                            width: 90%;              /* keep content within page width */
                            max-width: 210mm;        /* A4 content width */
                            margin: 0 auto;          /* center content */
                            padding: 10mm;
                            display: block;
                            box-sizing: border-box;
                        }
                        @media print {
                            @page {
                                size: A4 portrait;   /* keep portrait orientation */
                                margin: 10mm;        /* add printable margin */
                            }
                            .page {
                                width: 100%;
                                max-width: 210mm;    /* A4 content width */
                                margin: 0 auto;
                                padding: 10mm;
                            }
                            <!-- @page {
                                size: 356mm 547mm;
                                margin: 0;
                                orientation: portrait;
                            } -->
                            body {
                                font-family: Arial, sans-serif;
                                font-size: 12px;
                                line-height: 1.4;
                                margin: 0;
                                padding: 0;
                            }
                            <!-- .page {
                                width: 356mm;
                                min-height: auto;
                                margin: 0;
                                padding: 10mm;
                                display: block;
                            } -->
                        }
                        
                        @media screen {
                            body {
                                font-family: Arial, sans-serif;
                                font-size: 12px;
                                line-height: 1.4;
                                background-color: #f5f5f5;
                                margin: 0;
                                padding: 0;
                            }
                            .page {
                                width: 356mm;  /* 21.5 inches */
                                min-height: auto; /* Remove fixed height */
                                margin: 20px auto;
                                padding: 10mm;
                                background: white;
                                box-shadow: 0 0 10px rgba(0,0,0,0.1);
                                display: block;
                                box-sizing: border-box;
                            }
                        }
                    </style>
                </head>
                <body>
                    <div class="page">
                        <div style="width: 100%;">
                            <!-- Custom Header -->
                            <div style="width: 100%; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <!-- Left: Company Info -->
                                <!-- <div style="flex: 1; text-align: left;">
                                    <t t-if="doc.company_id.phone">
                                        <div>Tel:
                                            <t t-esc="doc.company_id.phone"/>
                                        </div>
                                    </t>
                                    <t t-if="doc.company_id.email">
                                        <div>Email:
                                            <t t-esc="doc.company_id.email"/>
                                        </div>
                                    </t>
                                    <t t-if="doc.company_id.website">
                                        <div>Website:
                                            <t t-esc="doc.company_id.website"/>
                                        </div>
                                    </t>
                                    <t t-if="doc.company_id.street or doc.company_id.city or doc.company_id.zip or doc.company_id.country_id">
                                        <div>
                                            <span t-esc="doc.company_id.street or ''"/>
                                            <span t-esc="doc.company_id.city and ', ' + doc.company_id.city or ''"/>
                                            <span t-esc="doc.company_id.zip and ' ' + doc.company_id.zip or ''"/>
                                            <span t-esc="doc.company_id.country_id and ', ' + doc.company_id.country_id.name or ''"/>
                                        </div>
                                    </t>
                                </div> -->
                                <!-- Center: Tax Invoice -->
                                <div style="flex: 1; text-align: center;">
                                    <h2 style="margin: 0 0 10px 0;">Tax Invoice</h2>
                                    <t t-if="doc.company_id.vat">
                                        <div>VAT:
                                            <t t-esc="doc.company_id.vat"/>
                                        </div>
                                    </t>
                                </div>
                                <!-- Right: Logo -->
                                <!-- <div style="flex: 1; text-align: right;">
                                    <t t-if="doc.company_id.logo">
                                        <img t-att-src="'data:image/png;base64,%s' % doc.company_id.logo.decode()" 
                                            style="height: 100px; width: 200px; object-fit: contain;"/>
                                    </t>
                                </div> -->
                            </div>
                            <!-- Selected Partner Information -->
                            <div style="width:100%; display:flex; justify-content:space-between; align-items:flex-start; padding-top: 40px;">
                                <!-- Left Side: POS Reference -->
                                <div style="display: flex; justify-content: start; flex-direction: column;">
                                    <div style="margin-bottom: 10px;">
                                        <t t-if="doc.pos_reference">
                                            <strong>#</strong>
                                            <t t-esc="doc.pos_reference"/>
                                        </t>
                                    </div>
                                    <div style="display:flex;">
                                        <t t-if="doc.session_id and doc.session_id.employee_id">
                                            <strong>Cashier:</strong>
                                            <t t-esc="doc.session_id.employee_id.name"/>
                                        </t>
                                    </div>
                                </div>
                                <!-- Right Side: Customer Info -->
                                <t t-if="selected_partner">
                                    <div style="background-color: #f8f9fa; margin-bottom: 20px;">
                                        <div style="display: flex; flex-direction: column; gap: 8px;">
                                            <div>
                                                <strong>Customer:</strong>
                                                <t t-esc="selected_partner.name"/>
                                            </div>
                                            <t t-if="selected_partner and selected_partner.email">
                                                <div>
                                                    <strong>Email:</strong>
                                                    <t t-esc="selected_partner.email"/>
                                                </div>
                                            </t>
                                            <t t-if="selected_partner and selected_partner.phone">
                                                <div>
                                                    <strong>Phone:</strong>
                                                    <t t-esc="selected_partner.phone"/>
                                                </div>
                                            </t>
                                            <t t-if="selected_partner and selected_partner.mobile">
                                                <div>
                                                    <strong>Mobile:</strong>
                                                    <t t-esc="selected_partner.mobile"/>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </t>
                            </div>
                            
                            <div style="border-top: 1px solid #ccc; margin: 20px 0;"></div>
                            <!-- Order Lines -->
                            <div class="row">
                                <div class="col-12">
                                    <table class="table table-bordered" style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr style="background-color: #f8f9fa;">
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: left; font-size: 12px;">Product</th>
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 12px;">Qty</th>
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">Unit Price</th>
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">Discount</th>
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">VAT %</th>
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">VAT Amount</th>
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="doc.lines" t-as="line">
                                                <tr>
                                                    <td style="border: 1px solid #ccc; padding: 8px; font-size: 12px;">
                                                        <t t-esc="line.product_id.name"/>
                                                        <t t-if="line.pack_lot_ids">
                                                            <t t-foreach="line.pack_lot_ids" t-as="lot">
                                                                <br/>
                                                                <small style="color: #666;">Serial:
                                                                    <t t-esc="lot.lot_name"/>
                                                                </small>
                                                            </t>
                                                        </t>
                                                        <t t-if="line.customer_note">
                                                            <br/>
                                                            <small style="color: #666;">Note:
                                                                <t t-esc="line.customer_note"/>
                                                            </small>
                                                        </t>
                                                    </td>
                                                    <td style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 12px;">
                                                        <t t-esc="line.qty"/>
                                                    </td>
                                                    <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">
                                                        <t t-esc="doc.currency_id.symbol or ''"/><t t-esc="'{:.2f}'.format(line.price_unit)"/>
                                                    </td>
                                                    <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">
                                                        <t t-if="line.discount_amount and line.discount_amount > 0">
                                                            <t t-esc="doc.currency_id.symbol or ''"/><t t-esc="'{:.2f}'.format(line.discount_amount)"/>
                                                        </t>
                                                        <t t-elif="line.discount and line.discount > 0">
                                                            <t t-esc="'{:.1f}'.format(line.discount)"/>%
                                                        </t>
                                                        <t t-else="">-</t>
                                                    </td>
                                                    <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">
                                                        <t t-if="line.tax_ids">
                                                            <t t-foreach="line.tax_ids" t-as="tax">
                                                                <t t-esc="'{:.1f}'.format(tax.amount)"/>%
                                                                <t t-if="not tax_last">, </t>
                                                            </t>
                                                        </t>
                                                        <t t-else="">-</t>
                                                    </td>
                                                    <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">
                                                        <t t-if="line.price_subtotal_incl != line.price_subtotal">
                                                            <t t-esc="doc.currency_id.symbol or ''"/><t t-esc="'{:.2f}'.format(line.price_subtotal_incl - line.price_subtotal)"/>
                                                        </t>
                                                        <t t-else="">-</t>
                                                    </td>
                                                    <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 12px;">
                                                        <t t-esc="doc.currency_id.symbol or ''"/><t t-esc="'{:.2f}'.format(line.price_subtotal)"/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- Totals -->
                            <div class="row">
                                <div class="col-6 offset-6">
                                    <table style="width: 100%; margin-top: 20px;">
                                        <tr>
                                            <td style="text-align: right; padding: 5px; font-size: 12px;">
                                                <strong>Subtotal:</strong>
                                            </td>
                                            <td style="text-align: right; padding: 5px; font-size: 12px;">
                                                <t t-esc="doc.currency_id.symbol or ''"/><t t-esc="'{:.2f}'.format(sum(line.price_subtotal for line in doc.lines))"/>
                                            </td>
                                        </tr>
                                        <t t-if="doc.amount_tax > 0">
                                            <tr>
                                                <td style="text-align: right; padding: 5px; font-size: 12px;">
                                                    <strong>VAT:</strong>
                                                </td>
                                                <td style="text-align: right; padding: 5px; font-size: 12px;">
                                                    <t t-esc="doc.currency_id.symbol or ''"/><t t-esc="'{:.2f}'.format(doc.amount_tax)"/>
                                                </td>
                                            </tr>
                                        </t>
                                        <tr style="border-top: 2px solid #000;">
                                            <td style="text-align: right; padding: 5px; font-size: 12px;">
                                                <strong>Total:</strong>
                                            </td>
                                            <td style="text-align: right; padding: 5px; font-size: 12px;">
                                                <strong>
                                                    <t t-esc="doc.currency_id.symbol or ''"/><t t-esc="'{:.2f}'.format(doc.amount_total)"/>
                                                </strong>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </body>
            </html>
        </t>
    </template>
    <!-- Report Action -->
    <record id="action_pos_order_report_doha" model="ir.actions.report">
        <field name="name">POS Order Receipt Doha</field>
        <field name="model">pos.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">custom_pos_receipt.pos_order_report_template_doha</field>
        <field name="report_file">custom_pos_receipt.pos_order_report_template_doha</field>
        <field name="binding_model_id" ref="point_of_sale.model_pos_order"/>
        <field name="binding_type">report</field>
    </record>
    <!-- Paperformat -->
    <!-- <record id="pos_order_report_doha_paperformat" model="report.paperformat">
        <field name="name">POS Receipt Doha Format</field>
        <field name="default" eval="False"/>
        <field name="format">custom</field>
        <field name="page_height">356</field>
        <field name="page_width">547</field>
        <field name="orientation">Landscape</field>
        <field name="margin_top">0</field>
        <field name="margin_bottom">0</field>
        <field name="margin_left">0</field>
        <field name="margin_right">0</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">0</field>
        <field name="dpi">90</field>
    </record> -->
</odoo>